<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8">
  <title>V-Eats</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
    }
  </script>
</head>
<body class="bg-emerald-50 dark:bg-emerald-900 text-gray-800 dark:text-gray-200 transition-colors duration-300">
  <nav class="p-4 bg-emerald-600 dark:bg-emerald-800 flex justify-between items-center shadow-lg transition-colors duration-300">
    <div class="flex items-center space-x-4">
      <h1 class="text-white font-bold text-2xl">V-Eats</h1>
    </div>

    <div class="flex items-center space-x-4">
      <!-- Navigation Links -->
      <div class="hidden md:flex items-center space-x-6">
        <a href="{% url 'users:home' %}" class="text-white hover:text-emerald-200 transition-colors duration-200 font-medium">Home</a>
        <a href="{% url 'restaurant:list' %}" class="text-white hover:text-emerald-200 transition-colors duration-200 font-medium">Restaurants</a>
        {% if user.is_authenticated and user.is_superuser %}
          <a href="{% url 'restaurant:add' %}" class="text-white hover:text-emerald-200 transition-colors duration-200 font-medium">Add Restaurant</a>
        {% endif %}
        <a href="#" class="text-white hover:text-emerald-200 transition-colors duration-200 font-medium">About</a>
        <a href="#" class="text-white hover:text-emerald-200 transition-colors duration-200 font-medium">Contact</a>
      </div>

      <!-- Auth Buttons -->
      <div class="flex items-center space-x-3">
        {% if user.is_authenticated %}
          <span class="text-white font-medium">Hello, {{ user.username }}!</span>
          {% if user.is_superuser %}
            <span class="text-emerald-200 text-sm">(Admin)</span>
          {% elif user.profile and user.profile.role == 'RESTAURANT' %}
            <span class="text-emerald-200 text-sm">(Restaurant)</span>
            <a href="{% url 'restaurant:dashboard' %}" class="text-emerald-200 hover:text-white transition-colors duration-200 font-medium text-sm">
              Dashboard
            </a>
          {% elif user.profile and user.profile.role == 'DRIVER' %}
            <span class="text-emerald-200 text-sm">(Driver)</span>
            <a href="{% url 'driver:dashboard' %}" class="text-emerald-200 hover:text-white transition-colors duration-200 font-medium text-sm">
              Dashboard
            </a>
          {% elif user.profile and user.profile.role == 'USER' %}
            <span class="text-emerald-200 text-sm">(Customer)</span>
          {% endif %}
          <a href="{% url 'users:logout' %}" class="bg-emerald-700 dark:bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-800 dark:hover:bg-emerald-700 transition-all duration-200 font-medium">
            Logout
          </a>
        {% else %}
          <a href="{% url 'users:login' %}" class="text-white hover:text-emerald-200 transition-colors duration-200 font-medium">
            Login
          </a>
          <a href="{% url 'users:register' %}" class="bg-emerald-700 dark:bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-800 dark:hover:bg-emerald-700 transition-all duration-200 font-medium">
            Register
          </a>
        {% endif %}
      </div>

      <!-- Dark Mode Toggle -->
      <button
        id="darkModeToggle"
        class="bg-emerald-700 dark:bg-emerald-600 text-white px-3 py-2 rounded-lg hover:bg-emerald-800 dark:hover:bg-emerald-700 transition-all duration-200 text-lg"
        title="Toggle dark mode"
      >
        <span id="darkModeIcon" class="block">🌙</span>
      </button>

      <!-- Mobile Menu Button -->
      <button
        id="mobileMenuButton"
        class="md:hidden text-white hover:text-emerald-200 transition-colors duration-200"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>
  </nav>

  <!-- Mobile Menu -->
  <div id="mobileMenu" class="hidden md:hidden bg-emerald-600 dark:bg-emerald-800 transition-colors duration-300">
    <div class="px-4 py-2 space-y-2">
      <a href="{% url 'users:home' %}" class="block text-white hover:text-emerald-200 transition-colors duration-200 font-medium py-2">Home</a>
      <a href="{% url 'restaurant:list' %}" class="block text-white hover:text-emerald-200 transition-colors duration-200 font-medium py-2">Restaurants</a>
      {% if user.is_authenticated and user.is_superuser %}
        <a href="{% url 'restaurant:add' %}" class="block text-white hover:text-emerald-200 transition-colors duration-200 font-medium py-2">Add Restaurant</a>
      {% endif %}
      <a href="#" class="block text-white hover:text-emerald-200 transition-colors duration-200 font-medium py-2">About</a>
      <a href="#" class="block text-white hover:text-emerald-200 transition-colors duration-200 font-medium py-2">Contact</a>
    </div>
  </div>

  <main>
    {% block content %}{% endblock %}
  </main>

  <script>
    // Dark mode functionality
    const darkModeToggle = document.getElementById('darkModeToggle');
    const darkModeIcon = document.getElementById('darkModeIcon');
    const html = document.documentElement;

    // Check for saved theme preference or default to 'dark'
    const savedTheme = localStorage.getItem('theme');
    const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

    if (savedTheme) {
      html.classList.toggle('dark', savedTheme === 'dark');
    } else if (systemPrefersDark) {
      html.classList.add('dark');
    }

    // Update icon based on current theme
    function updateIcon() {
      if (html.classList.contains('dark')) {
        darkModeIcon.textContent = '☀️';
      } else {
        darkModeIcon.textContent = '🌙';
      }
    }

    // Initialize icon
    updateIcon();

    // Toggle dark mode
    darkModeToggle.addEventListener('click', function() {
      html.classList.toggle('dark');
      const isDark = html.classList.contains('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
      updateIcon();
    });

    // Mobile menu functionality
    const mobileMenuButton = document.getElementById('mobileMenuButton');
    const mobileMenu = document.getElementById('mobileMenu');

    mobileMenuButton.addEventListener('click', function() {
      mobileMenu.classList.toggle('hidden');
    });

    // Close mobile menu when clicking outside
    document.addEventListener('click', function(event) {
      if (!mobileMenuButton.contains(event.target) && !mobileMenu.contains(event.target)) {
        mobileMenu.classList.add('hidden');
      }
    });

    // Handle window resize
    window.addEventListener('resize', function() {
      if (window.innerWidth >= 768) {
        mobileMenu.classList.add('hidden');
      }
    });
  </script>
</body>
</html>